<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on Janeiro, 9 2015 by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Manual do Maxima 5.35.71.g68475e4: 63. romberg</title>

<meta name="description" content="Manual do Maxima 5.35.71.g68475e4: 63. romberg">
<meta name="keywords" content="Manual do Maxima 5.35.71.g68475e4: 63. romberg">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 0px; padding-bottom: 0px;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}

-->
</style>

<link rel="icon" href="../figures/favicon.ico"/>
</head>

<body lang="pt" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="romberg"></a>
<a name="SEC231"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="maxima_62.html#SEC230" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC232" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima_62.html#SEC228" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC233" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC272" title="Index">&Iacute;ndice</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 63. romberg </h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC232">63.1 Definições para romberg</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Defini_00e7_00f5es-para-romberg"></a>
<a name="SEC232"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC231" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC233" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC231" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC231" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC233" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC272" title="Index">&Iacute;ndice</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 63.1 Definições para romberg </h2>

<dl>
<dt><u>Função:</u> <b>romberg</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX1844"></a>
</dt>
<dt><u>Função:</u> <b>romberg</b><i> (<var>F</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX1845"></a>
</dt>
<dd><p>Calcula uma integração numérica pelo método de Romberg.
</p>
<p><code>romberg(<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>
retorna uma estimativa da integral <code>integrate(<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>.
<var>expr</var> deve ser uma expressão que avalie para um valor em ponto flutuante
quando <var>x</var> estiver associado a um valor em ponto flutuante.
</p>
<p><code>romberg(<var>F</var>, <var>a</var>, <var>b</var>)</code>
retorna uma estimativa da integral <code>integrate(<var>F</var>(x), x, <var>a</var>, <var>b</var>)</code>
onde <code>x</code> representa o não nomeado, isolado argumeno de <var>F</var>;
o actual argumento não é chamado <code>x</code>.
<var>F</var> deve ser uma função do Maxima ou do Lisp que retorne um valor em ponto flutuante
quando o argumento for um número em ponto flutuante.
<var>F</var> pode nomear uma função traduzida ou compilada do Maxima.
</p>
<p>A precisão de <code>romberg</code> é governada pelas variáveis globais
<code>rombergabs</code> e <code>rombergtol</code>.
<code>romberg</code> termina com sucesso quando
a diferença absoluta entre duas aproximações sucessivas for menor que <code>rombergabs</code>,
ou a diferença relativa em aproximações sucessivas for menor que <code>rombergtol</code>.
Dessa forma quando <code>rombergabs</code> for 0.0 (o padrão)
somente o erro relativo tem algum efeito sobre <code>romberg</code>.
</p>
<p><code>romberg</code> divide ao meio o tamanho do passo no máximo <code>rombergit</code> vezes antes de interromper;
o número máximo de avaliações de função é portanto <code>2^rombergit</code>.
Se o critério de erro estabelecido por <code>rombergabs</code> e por <code>rombergtol</code>
não for satisfeito, <code>romberg</code> mostra uma mensagem de erro.
<code>romberg</code> sempre faz ao menos <code>rombergmin</code> iterações;
isso é uma intenção eurísstica de previnir encerramentos espúrios quando o integrando for oscilatório.
</p>
<p><code>romberg</code> repetidamente avalia o integrando após associar a variável
de integração a um valor específico (e não antes).
Essa política de avaliação torna possível aninhar chamadas a <code>romberg</code>,
para calcular integrais multidimensionais.
Todavia, os cálculos de erro não tomam os erros de integrações aninhadas
em consideração, então erros podem ser subestimados.
Também, métodos imaginados especialmente para problemas multidimensionais podem retornar
a mesma precisão com poucas avaliações de função.
</p>
<p><code>load(romberg)</code> torna essa função disponível para uso.
</p>
<p>Veja também <code>QUADPACK</code>, uma colecção de funções de integração numérica.
</p>
<p>Exemplos:
</p>
<p>Uma integração unidimensonal.
</p>
<pre class="example">(%i1) load (romberg);
(%o1)    /usr/share/maxima/5.11.0/share/numeric/romberg.lisp
(%i2) f(x) := 1/((x - 1)^2 + 1/100) + 1/((x - 2)^2 + 1/1000) + 1/((x - 3)^2 + 1/200);
                    1                 1                1
(%o2) f(x) := -------------- + --------------- + --------------
                     2    1           2    1            2    1
              (x - 1)  + ---   (x - 2)  + ----   (x - 3)  + ---
                         100              1000              200
(%i3) rombergtol : 1e-6;
(%o3)                 9.9999999999999995E-7
(%i4) rombergit : 15;
(%o4)                          15
(%i5) estimate : romberg (f(x), x, -5, 5);
(%o5)                   173.6730736617464
(%i6) exact : integrate (f(x), x, -5, 5);
(%o6) 10 sqrt(10) atan(70 sqrt(10))
 + 10 sqrt(10) atan(30 sqrt(10)) + 10 sqrt(2) atan(80 sqrt(2))
 + 10 sqrt(2) atan(20 sqrt(2)) + 10 atan(60) + 10 atan(40)
(%i7) abs (estimate - exact) / exact, numer;
(%o7)                7.5527060865060088E-11
</pre>
<p>Uma integração bidimensional, implementada com chamadas aninhadas a <code>romberg</code>.
</p>
<pre class="example">(%i1) load (romberg);
(%o1)    /usr/share/maxima/5.11.0/share/numeric/romberg.lisp
(%i2) g(x, y) := x*y / (x + y);
                                    x y
(%o2)                   g(x, y) := -----
                                   x + y
(%i3) rombergtol : 1e-6;
(%o3)                 9.9999999999999995E-7
(%i4) estimate : romberg (romberg (g(x, y), y, 0, x/2), x, 1, 3);
(%o4)                   0.81930239628356
(%i5) assume (x &gt; 0);
(%o5)                        [x &gt; 0]
(%i6) integrate (integrate (g(x, y), y, 0, x/2), x, 1, 3);
                                          3
                                    2 log(-) - 1
                    9                     2        9
(%o6)       - 9 log(-) + 9 log(3) + ------------ + -
                    2                    6         2
(%i7) exact : radcan (%);
                    26 log(3) - 26 log(2) - 13
(%o7)             - --------------------------
                                3
(%i8) abs (estimate - exact) / exact, numer;
(%o8)                1.3711979871851024E-10
</pre>
</dd></dl>

<dl>
<dt><u>Variável de opção:</u> <b>rombergabs</b>
<a name="IDX1846"></a>
</dt>
<dd><p>Valor por omissão: 0.0
</p>
<p>A precisão de <code>romberg</code> é governada pelas variávies globais
<code>rombergabs</code> e <code>rombergtol</code>.
<code>romberg</code> termina com sucesso quando
a diferença absoluta entre duas aproximações sucessivas for menor que <code>rombergabs</code>,
ou a diferença relativa em aproximações sucessivas for menor que <code>rombergtol</code>.
Dessa forma quando <code>rombergabs</code> for 0.0 (o padrão)
somente o erro relativo tem algum efeito sobre <code>romberg</code>.
</p>
<p>Veja também <code>rombergit</code> e <code>rombergmin</code>.
</p>
</dd></dl>

<dl>
<dt><u>Variável de opção:</u> <b>rombergit</b>
<a name="IDX1847"></a>
</dt>
<dd><p>Valor por omissão: 11
</p>
<p><code>romberg</code> divide ao meio o tamanho do passo no máximo <code>rombergit</code> vezes antes de interromper;
o número máximo de avaliações de função é portanto <code>2^rombergit</code>.
Se o critério de erro estabelecido por <code>rombergabs</code> e por <code>rombergtol</code>
não for satisfeito, <code>romberg</code> mostra uma mensagem de erro.
<code>romberg</code> sempre faz ao menos <code>rombergmin</code> iterações;
isso é uma intenção eurísstica de previnir encerramentos espúrios quando o integrando for oscilatório.
</p>
<p>Veja também <code>rombergabs</code> e <code>rombergtol</code>.
</p>
</dd></dl>

<dl>
<dt><u>Variável de opção:</u> <b>rombergmin</b>
<a name="IDX1848"></a>
</dt>
<dd><p>Valor por omissão: 0
</p>
<p><code>romberg</code> sempre faz ao menos <code>rombergmin</code> iterações;
isso é uma intenção eurísstica para prevenir terminações espúrias quando o integrando for.
</p>
<p>Veja também <code>rombergit</code>, <code>rombergabs</code>, e <code>rombergtol</code>.
</p>
</dd></dl>

<dl>
<dt><u>Variável de opção:</u> <b>rombergtol</b>
<a name="IDX1849"></a>
</dt>
<dd><p>Valor por omissão: 1e-4
</p>
<p>A precisão de <code>romberg</code> é governada pelas variáveis globais
<code>rombergabs</code> e <code>rombergtol</code>.
<code>romberg</code> termina com sucesso quando
a diferença absoluta entre duas aproximações sucessivas for menor que <code>rombergabs</code>,
ou a diferença relativa em aproximações sucessivas for menor que <code>rombergtol</code>.
Dessa forma quando <code>rombergabs</code> for 0.0 (o padrão)
somente o erro relativo tem algum efeito sobre <code>romberg</code>.
</p>
<p>Veja também <code>rombergit</code> e <code>rombergmin</code>.
</p>
</dd></dl>



<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC231" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC233" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC272" title="Index">&Iacute;ndice</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Robert Dodier</em> on <em>Janeiro, 9 2015</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
