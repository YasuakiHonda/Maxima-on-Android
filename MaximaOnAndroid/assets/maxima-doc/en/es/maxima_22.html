<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on septiembre, 1 2013 by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Manual de Maxima: 22. M&eacute;todos num&eacute;ricos</title>

<meta name="description" content="Manual de Maxima: 22. M&eacute;todos num&eacute;ricos">
<meta name="keywords" content="Manual de Maxima: 22. M&eacute;todos num&eacute;ricos">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
body
{
    color: black;
    background: white; 
    margin-left: 8%;
    margin-right: 13%;
}

h1
{
    margin-left: +8%;
    font-size: 150%;
    font-family: sans-serif
}

h2
{
    font-size: 125%;
    font-family: sans-serif
}

h3
{
    font-size: 100%;
    font-family: sans-serif
}

h2,h3,h4,h5,h6 { margin-left: +4%; }

div.textbox
{
    border: solid;
    border-width: thin;
    /* width: 100%; */
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em
}

div.titlebox
{
    border: none;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em;
    background: rgb(200,255,255);
    font-family: sans-serif
}

div.synopsisbox
{
    border: none;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em;
     background: rgb(255,220,255);
    /*background: rgb(200,255,255); */
    /* font-family: fixed */
}

pre.example
{
    border: 1px solid gray;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 1em;
    padding-right: 1em;
    /* background: rgb(247,242,180); */ /* kind of sandy */
    /* background: rgb(200,255,255); */ /* sky blue */
    background-color: #F1F5F9; /* light blue-gray */
    /* font-family: "Lucida Console", monospace */
}

div.spacerbox
{
    border: none;
    padding-top: 2em;
    padding-bottom: 2em
}

div.image
{
    margin: 0;
    padding: 1em;
    text-align: center;
}

div.categorybox
{
    border: 1px solid gray;
    padding-top: 0px;
    padding-bottom: 0px;
    padding-left: 1em;
    padding-right: 1em;
    background: rgb(247,242,220);
}


-->
</style>

<link rel="icon" href="http://maxima.sourceforge.net/favicon.ico"/>
</head>

<body lang="es" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="M_00e9todos-num_00e9ricos"></a>
<a name="SEC121"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="maxima_21.html#SEC120" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC122" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima_21.html#SEC118" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 22. M&eacute;todos num&eacute;ricos </h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC122">22.1 Introducci&oacute;n a la transformada r&aacute;pida de Fourier</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Funciones-y-variables-para-la-transformada-r_00e1pida-de-Fourier">&bull; Funciones y variables para la transformada r&aacute;pida de Fourier</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC123">22.2 Funciones para la resoluci&oacute;n num&eacute;rica de ecuaciones</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC124">22.3 Introducci&oacute;n a la resoluci&oacute;n num&eacute;rica de ecuaciones diferenciales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC125">22.4 Funciones para la resoluci&oacute;n num&eacute;rica de ecuaciones diferenciales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Introducci_00f3n-a-la-transformada-r_00e1pida-de-Fourier"></a>
<a name="SEC122"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC121" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC123" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC121" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC121" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 22.1 Introducci&oacute;n a la transformada r&aacute;pida de Fourier </h2>

<p>El paquete <code>fft</code> contiene funciones para el c&aacute;lculo num&eacute;rico (no simb&oacute;lico)
de la transformada r&aacute;pida de Fourier.
</p>





<a name="Funciones-y-variables-para-la-transformada-r_00e1pida-de-Fourier"></a>

<dl>
<dt><u>Funci&oacute;n:</u> <b>polartorect</b><i> (<var>magnitude_array</var>, <var>phase_array</var>)</i>
<a name="IDX902"></a>
</dt>
<dd><p>Transforma valores complejos de la forma <code>r %e^(%i t)</code> a la forma
<code>a + b %i</code>, siendo <var>r</var> el m&oacute;dulo y <var>t</var> la fase.
Ambos valores <var>r</var> y <var>t</var> son arrays unidimensionales cuyos
tam&ntilde;os son iguales a la misma potencia de dos.
</p>
<p>Los valores originales de los arrays de entrada son reemplazados por
las partes real e imaginaria, <code>a</code> y <code>b</code>, de los correspondientes
n&uacute;meros complejos. El resultado se calcula como
</p>
<pre class="example">a = r cos(t)
b = r sin(t)
</pre>
<p><code>polartorect</code> es la funci&oacute;n inversa de <code>recttopolar</code>.
</p>
<p>Para utilizar esta funci&oacute;n ejec&uacute;tese antes <code>load(fft)</code>.
V&eacute;ase tambi&eacute;n <code>fft</code>.
</p>
</dd></dl>



<dl>
<dt><u>Funci&oacute;n:</u> <b>recttopolar</b><i> (<var>real_array</var>, <var>imaginary_array</var>)</i>
<a name="IDX903"></a>
</dt>
<dd><p>Transforma valores complejos de la forma <code>a + b %i</code> a la forma
<code>r %e^(%i t)</code>, siendo <var>a</var> la parte real y <var>a</var> la imaginaria.
Ambos valores <var>a</var> y <var>b</var> son arrays unidimensionales cuyos
tam&ntilde;os son iguales a la misma potencia de dos.
</p>
<p>Los valores originales de los arrays de entrada son reemplazados por
los m&oacute;dulos y las fases, <code>r</code> y <code>t</code>, de los correspondientes
n&uacute;meros complejos. El resultado se calcula como
</p>
<pre class="example">r = sqrt(a^2 + b^2)
t = atan2(b, a)
</pre>
<p>El &aacute;ngulo calculado pertence al rango de <code>-%pi</code> a <code>%pi</code>. 
</p>
<p><code>recttopolar</code> es la funci&oacute;n inversa de <code>polartorect</code>.
</p>
<p>Para utilizar esta funci&oacute;n ejec&uacute;tese antes <code>load(fft)</code>.
V&eacute;ase tambi&eacute;n <code>fft</code>.
</p>
</dd></dl>



<dl>
<dt><u>Funci&oacute;n:</u> <b>inverse_fft</b><i> (<var>y</var>)</i>
<a name="IDX904"></a>
</dt>
<dd><p>Calcula la transformada inversa r&aacute;pida de Fourier.
</p>
<p><var>y</var> es una lista o array (declarado o no) que contiene los datos a
transformar. El n&uacute;mero de elementos debe ser una potencia de dos.
Los elementos deben ser n&uacute;meros literales (enteros, racionales,
de punto flotante o decimales grandes), constantes simb&oacute;licas,
expresiones del tipo <code>a + b*%i</code>, siendo <code>a</code> y <code>b</code>
n&uacute;meros literales, o constantes simb&oacute;licas.
</p>
<p>La funci&oacute;n <code>inverse_fft</code> devuelve un nuevo objeto del
mismo tipo que <var>y</var>, el cual no se ve modificado. Los
resultados se calculan siempre como decimales o expresiones <code>a + b*%i</code>,
siendo <code>a</code> y <code>b</code> decimales.
</p>
<p>La transformada inversa discreta de Fourier se define como se indica
a continuaci&oacute;n. Si <code>x</code> es el resultado de la transformada inversa,
entonces para <code>j</code> entre 0 y <code>n - 1</code> se tiene
</p>
<pre class="example">x[j] = sum(y[k] exp(-2 %i %pi j k / n), k, 0, n - 1)
</pre>
<p>Para utilizar esta funci&oacute;n ejec&uacute;tese antes <code>load(fft)</code>.
</p>
<p>V&eacute;anse tambi&eacute;n <code>fft</code> (transformada directa), <code>recttopolar</code> y <code>polartorect</code>.
</p>
<p>Ejemplos:
</p>
<p>Datos reales.
</p>
<pre class="example">(%i1) load (fft) $
(%i2) fpprintprec : 4 $
(%i3) L : [1, 2, 3, 4, -1, -2, -3, -4] $
(%i4) L1 : inverse_fft (L);
(%o4) [0.0, 14.49 %i - .8284, 0.0, 2.485 %i + 4.828, 0.0, 
                       4.828 - 2.485 %i, 0.0, - 14.49 %i - .8284]
(%i5) L2 : fft (L1);
(%o5) [1.0, 2.0 - 2.168L-19 %i, 3.0 - 7.525L-20 %i, 
4.0 - 4.256L-19 %i, - 1.0, 2.168L-19 %i - 2.0, 
7.525L-20 %i - 3.0, 4.256L-19 %i - 4.0]
(%i6) lmax (abs (L2 - L));
(%o6)                       3.545L-16
</pre>
<p>Datos complejos.
</p>
<pre class="example">(%i1) load (fft) $
(%i2) fpprintprec : 4 $                 
(%i3) L : [1, 1 + %i, 1 - %i, -1, -1, 1 - %i, 1 + %i, 1] $
(%i4) L1 : inverse_fft (L);
(%o4) [4.0, 2.711L-19 %i + 4.0, 2.0 %i - 2.0, 
- 2.828 %i - 2.828, 0.0, 5.421L-20 %i + 4.0, - 2.0 %i - 2.0, 
2.828 %i + 2.828]
(%i5) L2 : fft (L1);
(%o5) [4.066E-20 %i + 1.0, 1.0 %i + 1.0, 1.0 - 1.0 %i, 
1.55L-19 %i - 1.0, - 4.066E-20 %i - 1.0, 1.0 - 1.0 %i, 
1.0 %i + 1.0, 1.0 - 7.368L-20 %i]
(%i6) lmax (abs (L2 - L));                    
(%o6)                       6.841L-17
</pre>
</dd></dl>

<dl>
<dt><u>Funci&oacute;n:</u> <b>fft</b><i> (<var>x</var>)</i>
<a name="IDX905"></a>
</dt>
<dd><p>Calcula la transformada r&aacute;pida compleja de Fourier.
</p>
<p><var>x</var> es una lista o array (declarado o no) que contiene los datos a
transformar. El n&uacute;mero de elementos debe ser una potencia de dos.
Los elementos deben ser n&uacute;meros literales (enteros, racionales,
de punto flotante o decimales grandes), constantes simb&oacute;licas,
expresiones del tipo <code>a + b*%i</code>, siendo <code>a</code> y <code>b</code>
n&uacute;meros literales, o constantes simb&oacute;licas.
</p>
<p>La funci&oacute;n <code>fft</code> devuelve un nuevo objeto del
mismo tipo que <var>x</var>, el cual no se ve modificado. Los
resultados se calculan siempre como decimales o expresiones <code>a + b*%i</code>,
siendo <code>a</code> y <code>b</code> decimales.
</p>
<p>La transformada discreta de Fourier se define como se indica
a continuaci&oacute;n. Si <code>y</code> es el resultado de la transformada inversa,
entonces para <code>k</code> entre 0 y <code>n - 1</code> se tiene
</p>
<pre class="example">y[k] = (1/n) sum(x[j] exp(+2 %i %pi j k / n), j, 0, n - 1)
</pre>
<p>Si los datos <var>x</var> son reales, los coeficientes reales <code>a</code> y <code>b</code>
se pueden calcular de manera que 
</p>
<pre class="example">x[j] = sum(a[k]*cos(2*%pi*j*k/n)+b[k]*sin(2*%pi*j*k/n), k, 0, n/2)
</pre>
<p>con
</p>
<pre class="example">a[0] = realpart (y[0])
b[0] = 0
</pre>
<p>y, para k entre 1 y n/2 - 1,
</p>
<pre class="example">a[k] = realpart (y[k] + y[n - k])
b[k] = imagpart (y[n - k] - y[k])
</pre>
<p>y
</p>
<pre class="example">a[n/2] = realpart (y[n/2])
b[n/2] = 0
</pre>
<p>Para utilizar esta funci&oacute;n ejec&uacute;tese antes <code>load(fft)</code>.
</p>
<p>V&eacute;anse tambi&eacute;n <code>inverse_fft</code> (transformada inversa), <code>recttopolar</code> y <code>polartorect</code>.
</p>
<p>Ejemplos:
</p>
<p>Datos reales.
</p>
<pre class="example">(%i1) load (fft) $
(%i2) fpprintprec : 4 $
(%i3) L : [1, 2, 3, 4, -1, -2, -3, -4] $
(%i4) L1 : fft (L);
(%o4) [0.0, - 1.811 %i - .1036, 0.0, .6036 - .3107 %i, 0.0, 
                         .3107 %i + .6036, 0.0, 1.811 %i - .1036]
(%i5) L2 : inverse_fft (L1);
(%o5) [1.0, 2.168L-19 %i + 2.0, 7.525L-20 %i + 3.0, 
4.256L-19 %i + 4.0, - 1.0, - 2.168L-19 %i - 2.0, 
- 7.525L-20 %i - 3.0, - 4.256L-19 %i - 4.0]
(%i6) lmax (abs (L2 - L));
(%o6)                       3.545L-16
</pre>
<p>Datos complejos.
</p>
<pre class="example">(%i1) load (fft) $
(%i2) fpprintprec : 4 $
(%i3) L : [1, 1 + %i, 1 - %i, -1, -1, 1 - %i, 1 + %i, 1] $
(%i4) L1 : fft (L);
(%o4) [0.5, .3536 %i + .3536, - 0.25 %i - 0.25, 
0.5 - 6.776L-21 %i, 0.0, - .3536 %i - .3536, 0.25 %i - 0.25, 
0.5 - 3.388L-20 %i]
(%i5) L2 : inverse_fft (L1);
(%o5) [1.0 - 4.066E-20 %i, 1.0 %i + 1.0, 1.0 - 1.0 %i, 
- 1.008L-19 %i - 1.0, 4.066E-20 %i - 1.0, 1.0 - 1.0 %i, 
1.0 %i + 1.0, 1.947L-20 %i + 1.0]
(%i6) lmax (abs (L2 - L));
(%o6)                       6.83L-17
</pre>
<p>C&aacute;lculo de los coeficientes del seno y coseno.
</p>
<pre class="example">(%i1) load (fft) $
(%i2) fpprintprec : 4 $
(%i3) L : [1, 2, 3, 4, 5, 6, 7, 8] $
(%i4) n : length (L) $
(%i5) x : make_array (any, n) $
(%i6) fillarray (x, L) $
(%i7) y : fft (x) $
(%i8) a : make_array (any, n/2 + 1) $
(%i9) b : make_array (any, n/2 + 1) $
(%i10) a[0] : realpart (y[0]) $
(%i11) b[0] : 0 $
(%i12) for k : 1 thru n/2 - 1 do
   (a[k] : realpart (y[k] + y[n - k]),
    b[k] : imagpart (y[n - k] - y[k]));
(%o12)                        done
(%i13) a[n/2] : y[n/2] $
(%i14) b[n/2] : 0 $
(%i15) listarray (a);
(%o15)          [4.5, - 1.0, - 1.0, - 1.0, - 0.5]
(%i16) listarray (b);
(%o16)           [0, - 2.414, - 1.0, - .4142, 0]
(%i17) f(j) := sum (a[k] * cos (2*%pi*j*k / n) + b[k] * sin (2*%pi*j*k / n), k, 0, n/2) $
(%i18) makelist (float (f (j)), j, 0, n - 1);
(%o18)      [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0]
</pre>
</dd></dl>










<hr size="6">
<a name="Funciones-para-la-resoluci_00f3n-num_00e9rica-de-ecuaciones"></a>
<a name="SEC123"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC122" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC124" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC121" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC121" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 22.2 Funciones para la resoluci&oacute;n num&eacute;rica de ecuaciones </h2>



<dl>
<dt><u>Funci&oacute;n:</u> <b>horner</b><i> (<var>expr</var>, <var>x</var>)</i>
<a name="IDX906"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>horner</b><i> (<var>expr</var>)</i>
<a name="IDX907"></a>
</dt>
<dd><p>Cambia el formato de <var>expr</var> seg&uacute;n la regla de Horner utilizando <var>x</var> como variable principal, si &eacute;sta se especifica. El argumento <code>x</code> se puede omitir, en cuyo caso se considerar&aacute; como variable principal la de <var>expr</var> en su formato racional can&oacute;nico (CRE).
</p>
<p>La funci&oacute;n <code>horner</code> puede mejorar las estabilidad si <code>expr</code> va a ser num&eacute;ricamente evaluada. Tambi&eacute;n es &uacute;til si Maxima se utiliza para generar programas que ser&aacute;n ejecutados en Fortran. V&eacute;ase tambi&eacute;n <code>stringout</code>.
</p>
<pre class="example">(%i1) expr: 1e-155*x^2 - 5.5*x + 5.2e155;
                           2
(%o1)            1.0E-155 x  - 5.5 x + 5.2E+155
(%i2) expr2: horner (%, x), keepfloat: true;
(%o2)            (1.0E-155 x - 5.5) x + 5.2E+155
(%i3) ev (expr, x=1e155);
Maxima encountered a Lisp error:

 floating point overflow

Automatically continuing.
To reenable the Lisp debugger set *debugger-hook* to nil.
(%i4) ev (expr2, x=1e155);
(%o4)                       7.0E+154
</pre>
</dd></dl>


<dl>
<dt><u>Funci&oacute;n:</u> <b>find_root</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>abserr</var>, <var>relerr</var>])</i>
<a name="IDX908"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>find_root</b><i> (<var>f</var>, <var>a</var>, <var>b</var>, [<var>abserr</var>, <var>relerr</var>])</i>
<a name="IDX909"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>bf_find_root</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>abserr</var>, <var>relerr</var>])</i>
<a name="IDX910"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>bf_find_root</b><i> (<var>f</var>, <var>a</var>, <var>b</var>, [<var>abserr</var>, <var>relerr</var>])</i>
<a name="IDX911"></a>
</dt>
<dt><u>Variable opcional:</u> <b>find_root_error</b>
<a name="IDX912"></a>
</dt>
<dt><u>Variable opcional:</u> <b>find_root_abs</b>
<a name="IDX913"></a>
</dt>
<dt><u>Variable opcional:</u> <b>find_root_rel</b>
<a name="IDX914"></a>
</dt>
<dd><p>Calcula una ra&iacute;z de la expresi&oacute;n <var>expr</var> o de
la funci&oacute;n <var>f</var> en el intervalo cerrado <em>[<var>a</var>, <var>b</var>]</em>.
La expresi&oacute;n <var>expr</var> puede ser una ecuaci&oacute;n, en cuyo caso 
<code>find_root</code> busca una ra&iacute;z de
<code>lhs(<var>expr</var>) - rhs(<var>expr</var>)</code>.
</p>
<p>Dado que Maxima puede evaluar <var>expr</var> o <var>f</var> en 
<em>[<var>a</var>, <var>b</var>]</em>, entonces, si <var>expr</var> o <var>f</var> es
continua, <code>find_root</code> encuentrar&aacute; la ra&iacute;z
buscada, o ra&iacute;ces, en caso de existir varias.
</p>
<p>La funci&oacute;n <code>find_root</code> aplica al principio la
b&uacute;squeda por bipartici&oacute;n. Si la expresi&oacute;n es lo suficientemente
suave, entonces <code>find_root</code> aplicar&aacute; el m&eacute;todo
de interpolaci&oacute;n lineal.
</p>
<p><code>bf_find_root</code> es una versi&oacute;n de <code>find_root</code> para n&uacute;meros
reales de precisi&oacute;n arbitraria (bigfloat). La funci&oacute;n se 
eval&uacute;a utilizando la aritm&eacute;tica de estos n&uacute;meros, devolviendo
un resultado num&eacute;rico de este tipo. En cualquier otro aspecto,
<code>bf_find_root</code> es id&eacute;ntica a <code>find_root</code>, siendo la
explicaci&oacute;n que sigue igualmente v&aacute;lida para <code>bf_find_root</code>. 
</p>
<p>La precisi&oacute;n de <code>find_root</code> est&aacute; controlada por <code>abserr</code> y
<code>relerr</code>, que son claves opcionales para <code>find_root</code>. 
Estas claves toman la forma <code>key=val</code>. Las claves disponibles son:
</p>
<dl compact="compact">
<dt> <code>abserr</code></dt>
<dd><p>Error absoluto deseado de la funci&oacute;n en la ra&iacute;z. El
valor por defecto es <code>find_root_abs</code>. 
</p></dd>
<dt> <code>relerr</code></dt>
<dd><p>Error relativo deseado de la ra&iacute;z. El valor por defecto
es <code>find_root_rel</code>.
</p></dd>
</dl>

<p><code>find_root</code> se detiene cuando la funci&oacute;n alcanza un valor menor o
igual que <code>abserr</code>, o si las sucesivas aproximaciones <var>x_0</var>, <var>x_1</var>
difieren en no m&aacute;s que <code>relerr * max(abs(x_0), abs(x_1))</code>. Los
valores por defecto de <code>find_root_abs</code> y <code>find_root_rel</code> son
ambos cero.
</p>
<p><code>find_root</code> espera que la funci&oacute;n en cuesti&oacute;n tenga signos
diferentes en los extremos del intervalo.
Si la funci&oacute;n toma valores num&eacute;ricos en ambos extremos y estos
n&uacute;meros son del mismo signo, entonces
el comportamiento de <code>find_root</code> se controla con <code>find_root_error</code>.
Cuando <code>find_root_error</code> vale <code>true</code>, <code>find_root</code>
devuelve un mensaje de error; en caso contrario, <code>find_root</code>
devuelve el valor de <code>find_root_error</code>. El valor por defecto
de <code>find_root_error</code> es <code>true</code>.
</p>
<p>Si en alg&uacute;n momento del proceso de b&uacute;squeda <var>f</var> alcanza un valor
no num&eacute;rico, <code>find_root</code> devuelve una expresi&oacute;n parcialmente evaluada.
</p>
<p>Se ignora el orden de <var>a</var> y <var>b</var>; la regi&oacute;n de b&uacute;squeda es
<em>[min(<var>a</var>, <var>b</var>), max(<var>a</var>, <var>b</var>)]</em>.
</p>
<p>Ejemplos:
</p>
<pre class="example">(%i1) f(x) := sin(x) - x/2;
                                        x
(%o1)                  f(x) := sin(x) - -
                                        2
(%i2) find_root (sin(x) - x/2, x, 0.1, %pi);
(%o2)                   1.895494267033981
(%i3) find_root (sin(x) = x/2, x, 0.1, %pi);
(%o3)                   1.895494267033981
(%i4) find_root (f(x), x, 0.1, %pi);
(%o4)                   1.895494267033981
(%i5) find_root (f, 0.1, %pi);
(%o5)                   1.895494267033981
(%i6) find_root (exp(x) = y, x, 0, 100);
                            x
(%o6)           find_root(%e  = y, x, 0.0, 100.0)
(%i7) find_root (exp(x) = y, x, 0, 100), y = 10;
(%o7)                   2.302585092994046
(%i8) log (10.0);
(%o8)                   2.302585092994046
(%i9) fpprec:32;
(%o9)                           32
(%i10) bf_find_root (exp(x) = y, x, 0, 100), y = 10;
(%o10)                  2.3025850929940456840179914546844b0
(%i11) log(10b0);
(%o11)                  2.3025850929940456840179914546844b0
</pre>
</dd></dl>



<dl>
<dt><u>Funci&oacute;n:</u> <b>newton</b><i> (<var>expr</var>, <var>x</var>, <var>x_0</var>, <var>eps</var>)</i>
<a name="IDX915"></a>
</dt>
<dd><p>Devuelve una soluci&oacute;n aproximada de <code><var>expr</var> = 0</code> obtenida
por el m&eacute;todo de Newton, considerando <var>expr</var> como una funci&oacute;n
de una variable, <var>x</var>.
La b&uacute;squeda comienza con <code><var>x</var> = <var>x_0</var></code> y contin&uacute;a
hasta que se verifique <code>abs(<var>expr</var>) &lt; <var>eps</var></code>, donde
<var>expr</var> se eval&uacute;a con el valor actual de <var>x</var>.
</p>
<p>La funci&oacute;n <code>newton</code> permite que en <var>expr</var> haya variables
no definidas, siempre y cuando la condici&oacute;n de terminaci&oacute;n
<code>abs(<var>expr</var>) &lt; <var>eps</var></code> pueda reducirse a un valor
l&oacute;gico <code>true</code> o <code>false</code>; de este modo, no es necesario
que <var>expr</var> tome un valor num&eacute;rico.
</p>
<p>Ejec&uacute;tese <code>load(newton1)</code> para cargar esta funci&oacute;n.
</p>
<p>V&eacute;anse tambi&eacute;n <code>realroots</code>, <code>allroots</code>, <code>find_root</code> y <code>mnewton</code>.
</p>
<p>Ejemplos:
</p>
<pre class="example">(%i1) load (newton1);
(%o1) /usr/share/maxima/5.10.0cvs/share/numeric/newton1.mac
(%i2) newton (cos (u), u, 1, 1/100);
(%o2)                   1.570675277161251
(%i3) ev (cos (u), u = %);
(%o3)                 1.2104963335033528E-4
(%i4) assume (a &gt; 0);
(%o4)                        [a &gt; 0]
(%i5) newton (x^2 - a^2, x, a/2, a^2/100);
(%o5)                  1.00030487804878 a
(%i6) ev (x^2 - a^2, x = %);
                                           2
(%o6)                6.098490481853958E-4 a
</pre>
</dd></dl>







<hr size="6">
<a name="Introducci_00f3n-a-la-resoluci_00f3n-num_00e9rica-de-ecuaciones-diferenciales"></a>
<a name="SEC124"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC123" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC125" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC121" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC121" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 22.3 Introducci&oacute;n a la resoluci&oacute;n num&eacute;rica de ecuaciones diferenciales </h2>

<p>Las ecuaciones diferenciales ordinarias (EDO) que se resuelven con las funciones de esta
secci&oacute;n deben tener la forma
</p><pre class="example">       dy
       -- = F(x,y)
       dx
</pre><p>la cual es una EDO de primer orden. Las ecuaciones diferenciales de orden 
<var>n</var> deben escribirse como un sistema de <var>n</var> ecuaciones de primer
orden del tipo anterior. Por ejemplo, una EDO de segundo orden debe escribirse
como un sistema de dos ecuaciones,
</p><pre class="example">       dx               dy
       -- = G(x,y,t)    -- = F(x,y,t) 
       dt               dt
</pre>
<p>El primer argumento de las funciones debe ser una lista con las expresiones
de los miembros derechos de las EDOs. Las variables cuyas derivadas se representan
por las expresiones anteriores deben darse en una segunda lista. En el caso antes
citado, las variables son <var>x</var> y <var>y</var>. La variable independiente, <var>t</var>
en los mismos ejemplos anteriores, pueden darse mediante una opci&oacute;n adicional. 
Si las expresiones dadas no dependen de esa variable independiente, el sistema
recibe el nombre de aut&oacute;nomo.
</p>






<hr size="6">
<a name="Funciones-para-la-resoluci_00f3n-num_00e9rica-de-ecuaciones-diferenciales"></a>
<a name="SEC125"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC124" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC121" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC121" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 22.4 Funciones para la resoluci&oacute;n num&eacute;rica de ecuaciones diferenciales </h2>



<dl>
<dt><u>Funci&oacute;n:</u> <b>plotdf</b><i> (<var>dydx</var>, ...options...)</i>
<a name="IDX916"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>plotdf</b><i> (<var>dvdu</var>, <code>[</code><var>u</var>,<var>v</var><code>]</code>, ...options...)</i>
<a name="IDX917"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>plotdf</b><i> (<code>[</code><var>dxdt</var>,<var>dydt</var><code>]</code>, ...options...)</i>
<a name="IDX918"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>plotdf</b><i> (<code>[</code><var>dudt</var>,<var>dvdt</var><code>]</code>, <code>[</code><var>u</var>,<var>v</var><code>]</code>, ...options...)</i>
<a name="IDX919"></a>
</dt>
<dd><p>Dibuja un campo de direcciones en dos dimensiones <var>x</var> y <var>y</var>.
</p>
<p><var>dydx</var>, <var>dxdt</var> y <var>dydt</var> son expresiones que dependen de <var>x</var> y
<var>y</var>. Adem&aacute;s de esas dos variables, las dos expresiones pueden depender de
un conjunto de par&aacute;metros, con valores num&eacute;ricos que son dados por medio
de la opci&oacute;n <code>parameters</code> (la sintaxis de esa opci&oacute;n se explica mas al
frente), o con un rango de posibles valores definidos con la opci&oacute;n
<var>sliders</var>.
</p>
<p>Varias otras opciones se pueden incluir dentro del comando, o
seleccionadas en el men&uacute;.  Haciendo click en un punto del gr&aacute;fico se
puede hacer que sea dibujada la curva integral que pasa por ese punto;
lo mismo puede ser hecho dando las coordenadas del punto con la opci&oacute;n
<code>trajectory_at</code> dentro del comando plotdf. La direcci&oacute;n de
integraci&oacute;n se puede controlar con la opci&oacute;n <code>direction</code>, que
acepta valores de <em>forward</em>, <em>backward</em> ou <em>both</em>. El
n&uacute;mero de pasos realizado en la integraci&oacute;n num&eacute;rica se controla
con la opci&oacute;n <code>nsteps</code> y el incremento del tiempo en cada paso
con la opci&oacute;n <code>tstep</code>. Se usa el m&eacute;todo de Adams Moulton para
hacer la integraci&oacute;n num&eacute;rica; tambi&eacute;n es posible cambiar para el
m&eacute;todo de Runge-Kutta de cuarto orden con ajuste de pasos.
</p>
<p><b>Men&uacute; de la ventana del gr&aacute;fico:</b>
</p>
<p>El men&uacute; de la ventana gr&aacute;fica dispone de las siguientes opciones:
<em>Zoom</em>, que permite cambiar el comportamiento del rat&oacute;n, de
manera que har&aacute; posible el hacer zoom en la regi&oacute;n del gr&aacute;fico
haciendo clic con el bot&oacute;n izquierdo. Cada clic agranda la imagen
manteniendo como centro de la misma el punto sobre el cual se ha hecho
clic. Manteniendo pulsada la tecla <kbd>Shift</kbd> mientras se hace clic,
retrocede al tama&ntilde;o anterior. Para reanudar el c&aacute;lculo de las
trayectorias cuando se hace clic, seleccine la opci&oacute;n <em>Integrate</em>
del men&uacute;.
</p>
<p>La opci&oacute;n <em>Config</em> del men&uacute; se puede utilizar para cambiar
la(s) EDO(S) y algunos otros ajustes. Despu&eacute;s de hacer los cambios, se
debe utilizar la opci&oacute;n <em>Replot</em> para activar los nuevos ajustes.
Si en el campo <em>Trajectory at</em> del men&uacute; de di&aacute;logo de
<em>Config</em> se introducen un par de coordenadas y luego se pulsa la
tecla <kbd>retorno</kbd>, se mostrar&aacute; una nueva curva integral, adem&aacute;s de
las ya dibujadas.  Si se selecciona la opci&oacute;n <em>Replot</em>, s&oacute;lo se
mostrar&aacute; la &uacute;ltima curva integral seleccionada.
</p>
<p>Manteniendo pulsado el bot&oacute;n derecho del rat&oacute;n mientras se mueve el
cursor, se puede arrastrar el gr&aacute;fico horizontal y verticalmente.
Otros par&aacute;metros, como pueden ser el n&uacute;mero de pasos, el valor
inicial de <var>t</var>, las coordenadas del centro y el radio, pueden
cambiarse en el submen&uacute; de la opci&oacute;n <em>Config</em>.
</p>
<p>Con la opci&oacute;n <em>Save</em>, se puede obtener una copia del gr&aacute;fico en
una impresora Postscript o guardarlo en un fichero Postscript. Para
optar entre la impresi&oacute;n o guardar en fichero, se debe seleccionar
<em>Print Options</em> en la ventana de di&aacute;logo de <em>Config</em>. Una
vez cubiertos los campos de la ventana de di&aacute;logo de <em>Save</em>,
ser&aacute; necesario seleccionar la opci&oacute;n <em>Save</em> del primer men&uacute;
para crear el fichero o imprimir el gr&aacute;fico.
</p>
<p><b>Opciones gr&aacute;ficas:</b>
</p>
<p>La funci&oacute;n <code>plotdf</code> admite varias opciones, cada una de las cuales
es una lista de dos o m&aacute;s elementos. El primer elemento es el nombre de
la opci&oacute;n, y el resto est&aacute; formado por el valor o valores asignados
a dicha opci&oacute;n.
</p>
<p>La funci&oacute;n <code>plotdf</code> reconoce las siguientes opciones:
</p>
<ul>
<li>
<em>tstep</em> establece la amplitud de los incrementos en la
variable independiente <var>t</var>, utilizados para calcular la curva
integral. Si se aporta s&oacute;lo una expresi&oacute;n <var>dydx</var>, la variable
<var>x</var> ser&aacute; directamente proporcional a <var>t</var>.
El valor por defecto es 0.1.

</li><li>
<em>nsteps</em> establece el n&uacute;mero de pasos de longitud
<code>tstep</code> que se utilizar&aacute;n en la variable independiente para
calcular la curva integral.
El valor por defecto es 100.

</li><li>
<em>direction</em> establece la direcci&oacute;n de la variable
independiente que ser&aacute; seguida para calcular una curva integral.
Valores posibles son: <code>forward</code>, para hacer que la variable
independiente aumente <code>nsteps</code> veces, con incrementos <code>tstep</code>;
<code>backward</code>, para hacer que la variable independiente
disminuya; <code>both</code>, para extender la curva integral <code>nsteps</code>
pasos hacia adelante y <code>nsteps</code> pasos hacia atr&aacute;s.
Las palabras <code>right</code> y <code>left</code> se pueden utilizar como
sin&oacute;nimos de <code>forward</code> y <code>backward</code>.
El valor por defecto es <code>both</code>.

</li><li>
<em>tinitial</em> establece el valor inicial de la variable
<var>t</var> utilizado para calcular curvas integrales. Puesto que las
ecuaciones diferenciales son aut&oacute;nomas, esta opci&oacute;n s&oacute;lo
aparecer&aacute; en los gr&aacute;ficos de las curvas como funciones de <var>t</var>.
El valor por defecto es 0.

</li><li>
<em>versus_t</em> se utiliza para crear una segunda ventana
gr&aacute;fica, con el gr&aacute;fico de una curva integral, como dos funciones
<var>x</var>, <var>y</var>, de variable independiente <var>t</var>. Si se le da a
<code>versus_t</code> cualquier valor diferente de 0, se mostrar&aacute; la
segunda ventana gr&aacute;fica, la cual incluye otro men&uacute;, similar
al de la ventana principal.
El valor por defecto es 0.

</li><li>
<em>trajectory_at</em> establece las coordenadas <var>xinitial</var>
y <var>yinitial</var> para el extremo inicial de la curva integral.
No tiene asignado valor por defecto.

</li><li>
<em>parameters</em> establece una lista de par&aacute;metros,
junto con sus valores num&eacute;ricos, que son utilizados en la
definici&oacute;n de la ecuaci&oacute;n diferencial. Los nombres de los
par&aacute;metros y sus valores deben escribirse en formato de cadena
de caracteres como una secuencia de pares <code>nombre=valor</code>
separados por comas.

</li><li>
<em>sliders</em> establece una lista de par&aacute;metros que
se cambiar&aacute;n interactivamente utilizando barras de deslizamiento,
as&iacute; como los rangos de variaci&oacute;n de dichos par&aacute;metros.
Los nombres de los par&aacute;metros y sus rangos deben escribirse en formato
de cadena de caracteres como una secuencia de pares <code>nombre=min:max</code>
separados por comas.

</li><li>
<em>xfun</em> establece una cadena de caracteres con funciones
de <var>x</var> separadas por puntos y comas para ser representadas por
encima del campo de direcciones. Estas funciones ser&aacute;n interpretadas
por Tcl, no por Maxima.

</li><li>
<em>xradius</em> es la mitad de la longitud del rango de valores
a representar en la direcci&oacute;n x.
El valor por defecto es 10.

</li><li>
<em>yradius</em> es la mitad de la longitud del rango de valores
a representar en la direcci&oacute;n y.
El valor por defecto es 10.

</li><li>
<em>xcenter</em> es la coordenada x del punto situado en el centro
del gr&aacute;fico.
El valor por defecto es 0.

</li><li>
<em>ycenter</em> es la coordenada y del punto situado en el centro
del gr&aacute;fico.
El valor por defecto es 0.

</li><li>
<em>width</em> establece el ancho de la ventana gr&aacute;fica en
p&iacute;xeles.
El valor por defecto es 500.

</li><li>
<em>height</em> establece la altura de la ventana gr&aacute;fica en
p&iacute;xeles.
El valor por defecto es 500.

</li></ul>

<p><b>Ejemplos:</b>
</p>
<p>NOTA: Dependiendo de la interface que se use para Maxima, las funciones
que usan <code>openmath</code>, incluida <code>plotdf</code>, pueden desencadenar un
fallo si terminan en punto y coma, en vez del s&iacute;mbolo de
d&oacute;lar. Para evitar problemas, se usar&aacute; el s&iacute;mbolo de
d&oacute;lar en todos ejemplos.
</p>
<ul>
<li>
Para mostrar el campo de direcciones de la ecuaci&oacute;n diferencial
<em>y' = exp(-x) + y</em> y la soluci&oacute;n que pasa por <em>(2, -0.1)</em>:
<pre class="example">(%i1) load(&quot;plotdf&quot;)$

(%i2) plotdf(exp(-x)+y,[trajectory_at,2,-0.1]);
</pre>
<p><div class="image"><img src="./../figures/plotdf1.gif" alt="../figures/plotdf1"></div>
</p>
</li><li>
Para mostrar el campo de direcciones de la ecuaci&oacute;n 
<em>diff(y,x) = x - y^2</em> y la soluci&oacute;n de condici&oacute;n
inicial <em>y(-1) = 3</em>, se puede utilizar la sentencia:
<pre class="example">(%i3) plotdf(x-y^2,[xfun,&quot;sqrt(x);-sqrt(x)&quot;],
          [trajectory_at,-1,3], [direction,forward],
          [yradius,5],[xcenter,6]);
</pre><p>El gr&aacute;fico tambi&eacute;n muestra la funci&oacute;n <em>y = sqrt(x)</em>.
</p>
<p><div class="image"><img src="./../figures/plotdf2.gif" alt="../figures/plotdf2"></div>
</p>
</li><li>
El siguiente ejemplo muestra el campo de direcciones de un oscilador
arm&oacute;nico, definido por las ecuaciones <em>dx/dt = y</em> y
<em>dy/dt = -k*x/m</em>, y la curva integral que pasa por
<em>(x,y) = (6,0)</em>, con una barra de deslizamiento que 
permitir&aacute; cambiar el valor de <em>m</em> interactivamente
(<em>k</em> permanece fijo a 2):
<pre class="example">(%i4) plotdf([y,-k*x/m],[parameters,&quot;m=2,k=2&quot;],
            [sliders,&quot;m=1:5&quot;], [trajectory_at,6,0]);
</pre>
<p><div class="image"><img src="./../figures/plotdf3.gif" alt="../figures/plotdf3"></div>
</p>
</li><li>
Para representar el campo de direcciones de la ecuaci&oacute;n de
Duffing, <em>m*x&quot;+c*x'+k*x+b*x^3 = 0</em>, se introduce la
variable <em>y=x'</em> y se hace:
<pre class="example">(%i5) plotdf([y,-(k*x + c*y + b*x^3)/m],
              [parameters,&quot;k=-1,m=1.0,c=0,b=1&quot;],
              [sliders,&quot;k=-2:2,m=-1:1&quot;],[tstep,0.1]);
</pre>
<p><div class="image"><img src="./../figures/plotdf4.gif" alt="../figures/plotdf4"></div>
</p>
</li><li>
El campo de direcciones de un p&eacute;ndulo amortiguado,
incluyendo la soluci&oacute;n para condiciones iniciales dadas,
con una barra de deslizamiento que se puede utilizar para
cambiar el valor de la masa, <em>m</em>, y con el gr&aacute;fico
de las dos variables de estado como funciones del tiempo:

<pre class="example">(%i6) plotdf([y,-g*sin(x)/l - b*y/m/l],
         [parameters,&quot;g=9.8,l=0.5,m=0.3,b=0.05&quot;],
         [trajectory_at,1.05,-9],[tstep,0.01],
         [xradius,6],[yradius,14],
         [xcenter,-4],[direction,forward],[nsteps,300],
         [sliders,&quot;m=0.1:1&quot;], [versus_t,1]);
</pre>
<p><div class="image"><img src="./../figures/plotdf5.gif" alt="../figures/plotdf5"></div><div class="image"><img src="./../figures/plotdf6.gif" alt="../figures/plotdf6"></div>
</p>
</li></ul>

</dd></dl>



<dl>
<dt><u>Funci&oacute;n:</u> <b>ploteq</b><i> (<var>exp</var>, ...options...)</i>
<a name="IDX920"></a>
</dt>
<dd><p>Dibuja curvas equipotenciales para <var>exp</var>, que debe ser una expresi&oacute;n
dependiente de dos variables. Las curvas se obtienen integrando la ecuaci&oacute;n
diferencial que define las trayectorias ortogonales a las soluciones del 
sistema aut&oacute;nomo que se obtiene del gradiente de la expresi&oacute;n dada.
El dibujo tambi&eacute;n puede mostrar las curvas integrales de ese sistema
de gradientes (opci&oacute;n <code>fieldlines</code>).
</p>
<p>Este programa tambi&eacute;n necesita Xmaxima, incluso si se ejecuta Maxima desde
una consola, pues el dibujo se crear&aacute; por el c&oacute;digo Tk de Xmaxima.
Por defecto, la regi&oacute;n dibujada estar&aacute; vac&iacute;a hasta que el
usuario haga clic en un punto, d&eacute; sus coordenadas a trav&eacute;s del men&uacute; o
mediante la opci&oacute;n <code>trajectory_at</code>.
</p>
<p>La mayor parte de opciones aceptadas por <code>plotdf</code> se pueden utilizar
tambi&eacute;n con <code>ploteq</code> y el aspecto del interfaz es el mismo que el
descrito para <code>plotdf</code>.
</p>
<p>Ejemplo:
</p>
<pre class="example">(%i1) V: 900/((x+1)^2+y^2)^(1/2)-900/((x-1)^2+y^2)^(1/2)$
(%i2) ploteq(V,[x,-2,2],[y,-2,2],[fieldlines,&quot;blue&quot;])$
</pre>
<p>Haciendo clic sobre un punto se dibujar&aacute; la curva equipotencial que pasa por
ese punto (en rojo) y la trayectoria ortogonal (en azul).
</p>
</dd></dl>



<dl>
<dt><u>Funci&oacute;n:</u> <b>rk</b><i> (<var>ODE</var>, <var>var</var>, <var>initial</var>, <var>dominio</var>)</i>
<a name="IDX921"></a>
</dt>
<dt><u>Funci&oacute;n:</u> <b>rk</b><i> ([<var>ODE1</var>,...,<var>ODEm</var>], [<var>v1</var>,...,<var>vm</var>], [<var>init1</var>,...,<var>initm</var>], <var>dominio</var>)</i>
<a name="IDX922"></a>
</dt>
<dd><p>La primera forma se usa para resolver num&eacute;ricamente una ecuaci&oacute;n
diferencial ordinaria de primer orden (EDO), y la segunda forma resuelve
num&eacute;ricamente un sistema de <var>m</var> de esas ecuaciones, usando el m&eacute;todo
de Runge-Kutta de cuarto orden. <var>var</var> representa la variable dependiente.
EDO debe ser una expresi&oacute;n que dependa &uacute;nicamente de las variables
independiente y dependente, y define la derivada de la variable dependiente
en funci&oacute;n de la variable independiente.
</p>
<p>La variable independiente se representa con <var>dominio</var>, que debe ser
una lista con cuatro elementos, como por ejemplo:
</p><pre class="example">[t, 0, 10, 0.1]
</pre><p>el primer elemento de la lista identifica la variable independiente, el
segundo y tercer elementos son los valores inicial y final para esa
variable, y el &uacute;ltimo elemento da el valor de los incrementos que
deber&aacute;n ser usados dentro de ese intervalo.
</p>
<p>Si se van a resolver <var>m</var> ecuaciones, deber&aacute; haber <var>m</var>
variables dependientes <var>v1</var>, <var>v2</var>, ..., <var>vm</var>. Los valores
iniciales para esas variables ser&aacute;n <var>inic1</var>,
<var>inic2</var>, ..., <var>inicm</var>. Continuar&aacute; existiendo apenas una
variable independiente definida por la lista <var>domain</var>, como en
el caso anterior. <var>EDO1</var>, ..., <var>EDOm</var> son las expresiones que
definen las derivadas de cada una de las variables dependientes en
funci&oacute;n de la variable independiente. Las &uacute;nicas variables que
pueden aparecer en cada una de esas expresiones son la variable
independiente y cualquiera de las variables dependientes. Es importante
que las derivadas <var>EDO1</var>, ..., <var>EDOm</var> sean colocadas en la lista
en el mismo orden en que fueron agrupadas las variables dependientes;
por ejemplo, el tercer elemento de la lista ser&aacute; interpretado como la
derivada de la tercera variable dependiente.
</p>
<p>El programa intenta integrar las ecuaciones desde el valor inicial de la
variable independiente, hasta el valor final, usando incrementos
fijos. Si en alg&uacute;n paso una de las variables dependientes toma un
valor absoluto muy grande, la integraci&oacute;n ser&aacute; suspendida en ese
punto.  El resultado ser&aacute; una lista con un n&uacute;mero de elementos igual
al n&uacute;mero de iteraciones realizadas. Cada elemento en la lista de
resultados es tambi&eacute;n una lista con <var>m</var>+1 elementos: el valor de
la variable independiente, seguido de los valores de las variables
dependientes correspondientes a ese punto.
</p>
</dd></dl>



<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC121" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_23.html#SEC126" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_81.html#SEC376" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Robert Dodier</em> on <em>septiembre, 1 2013</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
